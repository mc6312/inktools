# Ink Tools

## ВВЕДЕНИЕ

1. Сие ПО является свободным, распространяемым под лицензией [GPL v3](https://www.gnu.org/licenses/gpl.html).
2. ПО создано и дорабатывается автором исключительно ради собственных
   нужд и развлечения, а также в соответствии с его представлениями об эргономике
   и функциональности.
3. Автор всех видал в гробу и ничего никому не должен, кроме явно
   прописанного в GPL.
4. Несмотря на вышеуказанное, автор совершенно не против, если ПО
   подойдёт кому-то еще, кроме тех, под кем прогорит сиденье из-за пунктов
   с 1 по 3.

## НАЗНАЧЕНИЕ

Набор костылей и велосипедов для учёта коллекции чернил.

В качестве эрзац-БД используются файлы формата Emacs Org Mode с
некоторой дополнительной (не нарушающей стандарт) разметкой.

## Требования ##

- Linux (или другая ОС, в которой заработает нижеперечисленное, напр.
  MS Windows с установленным MSYS2)
- Python 3.6 или новее
- для inktools (см. ниже) дополнительно требуется GTK 3.20 или новее и соотв. модули gi.repository

## Что запускать ##

Собственно inktools.

Она обрабатывает файлы .org, содержащие БД коллекции чернил,
и выводит статистику.

Файл должен быть указан в командной строке, иначе программа ищет файл
inks.org в своём каталоге.

Файл также может быть выбран из графического интерфейса.

Страницы интерфейса:

#### Статистика ####

Отображение статистики в виде таблиц - общей и детальной (по меткам).

#### Выбор чернил ####

Выбор чернил случайным образом - для страдающих от мук выбора "чем бы
пописать шедевр мирового значения".

Выбирает из чернил, имеющихся в наличии. Позволяет для уточнения выбора
указать два (необязательных) набора меток - те, которые нужно включать
в выбор, и те, которые из выбора нужно исключить.

#### Определение среднего цвета ####

Определение среднего цвета чернил по образцу (отсканированному или
сфотографированному изображению).

## Формат файлов ##

БД коллекции чернил представляет собой файл Emacs OrgMode с некоторыми
"расширениями", не ломающими совместимость, т.к. для штатного парсера
Emacs OrgMode они являются простым текстом.

Ветви дерева, содержащие описания чернил, должны иметь метку "ink".

Статус ветвей:

  * не указан: чернила НЕ планируются к покупке (т.к. забракованы по
    какой-либо причине, в т.ч. по результатам испытаний);
  * TODO: чернила планируются к покупке и/или испытанию;
  * DONE: чернила были куплены и испытаны.

Наличие чернил в коллекции описано отдельно (см. ниже описание данных
в текстовых полях) и статусом TODO/DONE/... не указывается.

Упрощенный образец ветви описания чернил:

    * TODO Ink Name :ink:метка1:...:меткаN:
    Густые чернила серо-буро-малинового цвета.
    * параметры
      цвет: #603033
      основной цвет: some_tag
    * в наличии
      флакон 30 мл

### Подветви описания чернил ###

Ветви типа Org Headline Nodes, расположенные уровнем ниже (внутри) ветви
описания чернил. Наличие этих ветвей не обязательно, но желательно
для сбора статистики.

Могут содержать ключевые слова с параметрами (см. ниже).

Некоторые ветви могут иметь разные варианты названий.

Ключевое слово должно начинаться в начале строки, и может заканчиваться
двоеточием (для удобочитаемости), если есть параметры.

Параметры (если они есть) отделяются
от ключевого слова одним или несколькими пробелами.

Неизвестные ключевые слова и/или их неправильные параметры текущей версией
ПО игнорируются, а с т.з. стандартного парсера Emacs в любом случае
являются простым текстом.

#### Ветвь "параметры" ####

Может содержать строку вида "параметр: значение".

##### цвет: #RRGGBB #####

Образец основного цвета чернил (полученный из отсканированного образца).

##### основной цвет: метка #####

Название основного цвета чернил. Должна быть указана метка из тех, что
перечислены в директиве TAGS, или человеко-читаемое название метки,
соответствующее одному из перечисленных в директиве @TAGNAMES.

Внимание! Рекомендуется использовать метку, соответствующую группе
цветов, к которой относит чернила производитель.

Для примера: чернила Sailor Blue Black относятся к группе т.н. "сине-чёрных"
(или "тёмно-синих" на нормальном русском языке), хотя фактический цвет
этих чернил скорее сине-фиолетовый и ближе к "Royal Blue".

#### Ветвь "в наличии" (или "наличие") ####

В тексте такой ветви для учёта наличия чернил ПО ищет строки вида
"флакон NN мл" и/или "картридж".

#### Ветвь "использование" (или "заправки") ####

Содержит строки вида "дата[: комментарий]" с датами очередного
использования чернил (в первую очередь - заправки в ручку).

Допустимые форматы даты: ДД.ММ.ГГГГ, ДД-ММ-ГГГГ, ГГГГ-ММ-ДД.
Даты в других форматах или даты со значениями полей вне допустимого
диапазона при сборе статистики считается примечаниями и для сбора
статистики не используется.

Комментарий необязателен, а если есть - имеет смысл указывать в нём
название ручки, в которую заправлены соответствующие чернила.
Ветвь "использование" нужна для статистики популярности чернил.

### Данные, помещаемые в комментарии ###

Строки вида "# @KEYWORD параметры".

После символа комментария обязателен пробел, чтобы стандартный парсер
не спотыкался.

@TAGSTAT Общий заголовок:заголовок 1го столбца:метка [... метка]

Шаблон для вывода таблицы статистики, требует трёх параметров, разделяющихся
символом ":".

  1. "общий заголовок" - название таблицы,
  2. заголовок 1го столбца,
  3. метки, разделённые пробелами

Пример: # @TAGSTAT По цветам:Цвет:black blue blue_black gray green

@TAGNAMES метка=название:[...:меткаN=названиеN:]

Соответствие меток Emacs OrgMode (которые не могут содержать пробелов
и некоторых других символов) и человекочитаемых строк, для отображения
в таблицах статистики.

Пример: # @TAGNAMES dark=тёмные:black=чёрные:blue=синие:blue_black=сине-чёрные:
